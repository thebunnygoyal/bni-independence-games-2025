<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNI Independence Games 2.0 - Victory Strategic Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            color: #212529;
            min-height: 100vh;
        }
        
        /* BNI Color Scheme */
        :root {
            --bni-red: #C41E3A;
            --bni-red-dark: #A01729;
            --bni-red-light: #E8495F;
            --bni-white: #FFFFFF;
            --bni-gray: #6C757D;
            --bni-light-gray: #F8F9FA;
            --bni-dark: #212529;
            --success-green: #28A745;
            --warning-orange: #FD7E14;
            --danger-red: #DC3545;
            --harvey-gold: #D4AF37;
        }
        
        /* Harvey Specter Enhancement - Winning Indicators */
        .harvey-winner {
            background: linear-gradient(45deg, var(--harvey-gold), #FFD700);
            color: var(--bni-dark);
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: bold;
            animation: victoryPulse 2s infinite;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        
        @keyframes victoryPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 6px 20px rgba(212, 175, 55, 0.6); }
        }
        
        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, var(--bni-red) 0%, var(--bni-red-dark) 100%);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            border-bottom: 3px solid var(--bni-white);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.3);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--bni-white);
            text-decoration: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
        }
        
        .nav-links a {
            color: var(--bni-white);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 6px;
        }
        
        .nav-links a:hover, .nav-links a.active {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* Main Content */
        .main-content {
            margin-top: 90px;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Page Sections */
        .page-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .page-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Header */
        .hero-header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--bni-red) 0%, var(--bni-red-light) 100%);
            color: var(--bni-white);
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 15px 35px rgba(196, 30, 58, 0.3);
        }
        
        .hero-header h1 {
            font-size: 3.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .hero-header .subtitle {
            font-size: 1.3em;
            margin-bottom: 10px;
            opacity: 0.95;
        }
        
        .harvey-quote {
            font-style: italic;
            font-size: 1.2em;
            margin-top: 15px;
            opacity: 0.9;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
            padding-top: 15px;
            background: rgba(0,0,0,0.1);
            border-radius: 10px;
            padding: 15px;
        }
        
        /* Cards and Layouts */
        .card {
            background: var(--bni-white);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(196, 30, 58, 0.1);
            margin-bottom: 30px;
        }
        
        .card h2, .card h3 {
            color: var(--bni-red);
            margin-bottom: 25px;
            text-align: center;
            font-size: 2.2em;
            border-bottom: 3px solid var(--bni-red);
            padding-bottom: 15px;
        }
        
        /* Enhanced Leaderboard */
        .chapter-row {
            display: grid;
            grid-template-columns: 60px 150px 1fr 100px 100px 100px 100px 120px 80px;
            gap: 15px;
            padding: 20px;
            margin: 15px 0;
            background: var(--bni-light-gray);
            border-radius: 12px;
            align-items: center;
            transition: all 0.3s ease;
            border-left: 5px solid transparent;
        }
        
        .chapter-row:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            background: var(--bni-white);
        }
        
        .chapter-row.rank-1 {
            border-left-color: var(--harvey-gold);
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.15), var(--bni-light-gray));
        }
        
        .chapter-row.rank-2 {
            border-left-color: #C0C0C0;
            background: linear-gradient(90deg, rgba(192, 192, 192, 0.1), var(--bni-light-gray));
        }
        
        .chapter-row.rank-3 {
            border-left-color: #CD7F32;
            background: linear-gradient(90deg, rgba(205, 127, 50, 0.1), var(--bni-light-gray));
        }
        
        .rank {
            font-size: 2em;
            font-weight: bold;
            color: var(--bni-red);
            text-align: center;
        }
        
        .chapter-name {
            font-weight: bold;
            font-size: 1.1em;
            color: var(--bni-dark);
        }
        
        .victory-highlight {
            background: linear-gradient(45deg, var(--bni-red), var(--bni-red-light));
            color: var(--bni-white);
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: bold;
            animation: pulse 2s infinite;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.3);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .metric {
            text-align: center;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .metric.positive {
            color: var(--success-green);
        }
        
        .metric.negative {
            color: var(--danger-red);
        }
        
        .metric.warning {
            color: var(--warning-orange);
        }
        
        /* Harvey's Strategic Intelligence Panel */
        .harvey-intelligence {
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            color: #ffffff;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid var(--harvey-gold);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }
        
        .harvey-intelligence h3 {
            color: var(--harvey-gold);
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        
        .intelligence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .intel-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--harvey-gold);
            backdrop-filter: blur(10px);
        }
        
        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            background: var(--bni-light-gray);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(196, 30, 58, 0.1);
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--bni-red);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(196, 30, 58, 0.2);
            border-radius: 8px;
            background: var(--bni-white);
            color: var(--bni-dark);
            font-size: 1em;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--bni-red);
            box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--bni-red), var(--bni-red-dark));
            color: var(--bni-white);
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            margin: 5px;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(196, 30, 58, 0.4);
            background: linear-gradient(135deg, var(--bni-red-dark), var(--bni-red));
        }
        
        .btn-harvey {
            background: linear-gradient(135deg, var(--harvey-gold), #FFD700);
            color: var(--bni-dark);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }
        
        .btn-harvey:hover {
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--bni-gray), #495057);
            color: var(--bni-white);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-green), #1E7E34);
            color: var(--bni-white);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-red), #C82333);
            color: var(--bni-white);
        }
        
        /* Strategic Analysis */
        .strategy-panel {
            background: linear-gradient(135deg, var(--bni-white), var(--bni-light-gray));
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid var(--bni-red);
            box-shadow: 0 8px 25px rgba(196, 30, 58, 0.1);
        }
        
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .insight-card {
            background: var(--bni-white);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--bni-red);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .priority-critical {
            border-left-color: var(--danger-red);
            background: rgba(220, 53, 69, 0.05);
        }
        
        .priority-high {
            border-left-color: var(--warning-orange);
            background: rgba(253, 126, 20, 0.05);
        }
        
        .priority-medium {
            border-left-color: var(--success-green);
            background: rgba(40, 167, 69, 0.05);
        }
        
        /* Victory Status Indicator */
        .victory-status {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 999;
            backdrop-filter: blur(10px);
            border: 2px solid var(--harvey-gold);
        }
        
        /* Messages */
        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 600;
            display: none;
        }
        
        .message-success {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid var(--success-green);
            color: var(--success-green);
        }
        
        .message-error {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid var(--danger-red);
            color: var(--danger-red);
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .chapter-row {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 10px;
            }
            
            .hero-header h1 {
                font-size: 2.5em;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .victory-status {
                position: relative;
                top: auto;
                right: auto;
                margin: 20px 0;
            }
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(196, 30, 58, 0.3);
            border-radius: 50%;
            border-top-color: var(--bni-red);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Official Formula Display */
        .formula-box {
            background: rgba(196, 30, 58, 0.1);
            border: 1px solid var(--bni-red);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9em;
        }
        
        .highlight-victory {
            background: linear-gradient(135deg, var(--bni-red), var(--bni-red-light));
            color: var(--bni-white);
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: bold;
        }
        
        /* Harvey Specter Winner Indicator */
        .harvey-winner-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--harvey-gold);
            color: var(--bni-dark);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8em;
            animation: victoryPulse 2s infinite;
        }
    </style>
</head>
<body>
    <!-- Victory Status Indicator -->
    <div class="victory-status" id="victoryStatus">
        <div style="text-align: center;">
            <strong>VICTORY STATUS</strong>
            <div id="liveRank">Loading...</div>
            <div id="liveScore">Calculating...</div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo">üèÜ BNI VICTORY COMMAND CENTER</a>
            <div class="nav-links">
                <a href="#" onclick="showPage('leaderboard')" class="active">Live Intel</a>
                <a href="#" onclick="showPage('tracking')">Victory Data</a>
                <a href="#" onclick="showPage('rules')">Rules & Regs</a>
                <a href="#" onclick="showPage('analytics')">Harvey's Analytics</a>
                <a href="#" onclick="showPage('sheets')">Data Ops</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            
            <!-- Leaderboard Page -->
            <div id="leaderboard" class="page-section active">
                <div class="hero-header">
                    <h1>üéØ LIVE COMPETITIVE INTELLIGENCE</h1>
                    <div class="subtitle">Real-Time Strategic Positioning - Independence Games 2.0</div>
                    <div class="subtitle">Mission Duration: 17th June ‚Äì 1st August 2025 (6 Weeks)</div>
                    <div class="harvey-quote">
                        "When you're backed against the wall, break the goddamn thing down. Victory doesn't come to those who wait - it comes to those who calculate, execute, and dominate." - Harvey Specter
                    </div>
                </div>

                <div class="harvey-intelligence">
                    <h3>üß† HARVEY'S STRATEGIC INTELLIGENCE</h3>
                    <div class="intelligence-grid">
                        <div class="intel-card">
                            <h4>üéØ Victory's Current Position</h4>
                            <div id="harveyIntel1">Analyzing competitive landscape...</div>
                        </div>
                        <div class="intel-card">
                            <h4>‚ö° Immediate Action Required</h4>
                            <div id="harveyIntel2">Calculating optimal moves...</div>
                        </div>
                        <div class="intel-card">
                            <h4>üèÜ Path to Championship</h4>
                            <div id="harveyIntel3">Mapping victory trajectory...</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>üìä LIVE CHAPTER RANKINGS</h2>
                    <div style="margin-bottom: 20px; text-align: center;">
                        <span id="lastUpdate" style="color: var(--bni-red); font-weight: bold;">Last Updated: Loading...</span>
                        <button class="btn" onclick="refreshLeaderboard()">üîÑ Refresh Intel</button>
                        <button class="btn btn-success" onclick="autoRefresh()" id="autoBtn">‚ö° Auto-Refresh: OFF</button>
                        <button class="btn btn-harvey" onclick="generateStrategicReport()">üìã Harvey's Report</button>
                    </div>
                    
                    <div id="leaderboardContent">
                        <!-- Leaderboard will be populated here -->
                    </div>
                </div>

                <div class="strategy-panel">
                    <h3 style="color: var(--bni-red); margin-bottom: 20px;">üéØ Victory Chapter Strategic Analysis</h3>
                    <div id="victoryAnalysis">
                        <div class="insight-card priority-critical">
                            <strong>STRATEGIC STATUS:</strong> <span id="victoryStatus2">Analyzing competitive position...</span>
                        </div>
                        <div class="insight-card priority-high">
                            <strong>HARVEY'S ORDERS:</strong> <span id="nextMoves">Calculating optimal strategy...</span>
                        </div>
                        <div class="insight-card priority-medium">
                            <strong>COMPETITIVE EDGE:</strong> <span id="competitiveEdge">Evaluating strategic advantages...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Victory Tracking Page -->
            <div id="tracking" class="page-section">
                <div class="hero-header">
                    <h1>üìà VICTORY DATA COMMAND CENTER</h1>
                    <div class="subtitle">Official BNI Independence Games 2.0 Metrics</div>
                    <div class="harvey-quote">
                        "I don't have dreams, I have goals. And right now, Victory's goal is total domination." - Harvey Specter
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Official Weekly Data Entry</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Current Week</label>
                            <select id="currentWeek" onchange="loadWeekData()">
                                <option value="1">Week 1 (June 17-23)</option>
                                <option value="2">Week 2 (June 24-30)</option>
                                <option value="3">Week 3 (July 1-7)</option>
                                <option value="4">Week 4 (July 8-14)</option>
                                <option value="5">Week 5 (July 15-21)</option>
                                <option value="6">Week 6 (July 22-Aug 1)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Chapter Strength (Weekly Palms)</label>
                            <input type="number" id="chapterStrength" value="25" onchange="calculateOfficialMetrics()">
                            <small>As per weekly Palms data</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Weekly Referrals</label>
                            <input type="number" id="weeklyReferrals" value="0" onchange="calculateOfficialMetrics()">
                        </div>
                        
                        <div class="form-group">
                            <label>Weekly Visitors</label>
                            <input type="number" id="weeklyVisitors" value="0" onchange="calculateOfficialMetrics()">
                            <small>EOI Form mandatory within 24 hours</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Members Present</label>
                            <input type="number" id="membersPresent" value="25" onchange="calculateOfficialMetrics()">
                            <small>Photo required by 9AM meeting day</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Total Testimonials (Season)</label>
                            <input type="number" id="totalTestimonials" value="0" onchange="calculateOfficialMetrics()">
                            <small>Max 2 per player (Capped)</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Total Trainings (Season)</label>
                            <input type="number" id="totalTrainings" value="0" onchange="calculateOfficialMetrics()">
                            <small>Max 3 per player (Capped)</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Net Retention Score</label>
                            <input type="number" id="netRetention" value="0" onchange="calculateOfficialMetrics()">
                            <small>Min qualifier: +3</small>
                        </div>

                        <div class="form-group">
                            <label>Inductions</label>
                            <input type="number" id="inductions" value="0" onchange="calculateOfficialMetrics()">
                            <small>Within 8 participating chapters only</small>
                        </div>

                        <div class="form-group">
                            <label>Renewals</label>
                            <input type="number" id="renewals" value="0" onchange="calculateOfficialMetrics()">
                        </div>

                        <div class="form-group">
                            <label>Drops</label>
                            <input type="number" id="drops" value="0" onchange="calculateOfficialMetrics()">
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn" onclick="calculateOfficialMetrics()">üìä Calculate Victory Metrics</button>
                        <button class="btn btn-success" onclick="saveToSheets()">üíæ Save to Command Center</button>
                        <button class="btn btn-harvey" onclick="harveyAnalysis()">üß† Harvey's Analysis</button>
                    </div>
                </div>

                <div id="metricsResults" class="strategy-panel">
                    <h3 style="color: var(--bni-red); margin-bottom: 20px;">üéØ Official Victory Metrics</h3>
                    <div class="strategy-grid" id="calculatedMetrics">
                        <!-- Metrics will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Official Rules Page -->
            <div id="rules" class="page-section">
                <div class="hero-header">
                    <h1>üìú OFFICIAL RULES & REGULATIONS</h1>
                    <div class="subtitle">Complete BNI Independence Games 2.0 Rulebook</div>
                    <div class="harvey-quote">
                        "Winners don't make excuses when the other side plays the game. They know the rules better than anyone else." - Harvey Specter
                    </div>
                </div>

                <div class="card">
                    <h2>üèÜ The Battlefield - 8 Competing Chapters</h2>
                    <div class="strategy-grid">
                        <div class="insight-card" style="position: relative;">
                            <div class="harvey-winner-indicator">üëë</div>
                            <h4>VICTORY - Our Chapter</h4>
                            <p><strong>Status:</strong> <span class="harvey-winner">TARGET FOR CHAMPIONSHIP</span></p>
                            <p><strong>Strategy:</strong> Total domination through systematic execution</p>
                            <p><strong>Harvey's Assessment:</strong> "Victory has the tools. Now we execute."</p>
                        </div>
                        <div class="insight-card">
                            <h4>Competition Analysis</h4>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>INCREDIBLEZ - Strong early performer</li>
                                <li>KNIGHTZ - Consistent but predictable</li>
                                <li>ETERNAL - Underestimated threat</li>
                                <li>CELEBRATIONS - Momentum-based</li>
                                <li>OPULANCE - Resource-heavy approach</li>
                                <li>EPIC - Innovation-focused</li>
                                <li>ACHIEVERZ - Traditional strategy</li>
                            </ul>
                        </div>
                        <div class="insight-card priority-critical">
                            <h4>Game Timeline</h4>
                            <p><strong>Mission Start:</strong> 17th June 2025</p>
                            <p><strong>Final Battle:</strong> 1st August 2025</p>
                            <p><strong>Duration:</strong> 6 Weeks of Strategic Warfare</p>
                            <p><strong>Victory Window:</strong> Every day counts</p>
                        </div>
                    </div>
                </div>

                <!-- Detailed rules sections would continue here -->
            </div>

            <!-- Harvey's Analytics Page -->
            <div id="analytics" class="page-section">
                <div class="hero-header">
                    <h1>üß† HARVEY'S STRATEGIC ANALYTICS</h1>
                    <div class="subtitle">Advanced Competitive Intelligence Dashboard</div>
                    <div class="harvey-quote">
                        "The only time success comes before work is in the dictionary. But intelligence? That comes before everything." - Harvey Specter
                    </div>
                </div>

                <div class="harvey-intelligence">
                    <h3>üéØ STRATEGIC ANALYSIS DASHBOARD</h3>
                    <div class="intelligence-grid">
                        <div class="intel-card">
                            <h4>üèÜ Victory Probability Model</h4>
                            <div id="winProbability">Calculating championship odds...</div>
                        </div>
                        
                        <div class="intel-card">
                            <h4>üìä Competitive Threat Assessment</h4>
                            <div id="threatAnalysis">Analyzing competition weaknesses...</div>
                        </div>
                        
                        <div class="intel-card">
                            <h4>‚ö° Optimal Strategy Engine</h4>
                            <div id="strategyEngine">Generating winning moves...</div>
                        </div>
                        
                        <div class="intel-card">
                            <h4>üé™ Market Intelligence</h4>
                            <button class="btn btn-harvey" onclick="addIntelligence()">üìù Add Intel</button>
                            <button class="btn btn-secondary" onclick="exportAnalytics()">üì§ Export Analysis</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üéØ Harvey's Strategic Recommendations</h3>
                    <div id="strategicRecommendations" class="strategy-grid">
                        <!-- Recommendations will be populated -->
                    </div>
                </div>
            </div>

            <!-- Data Operations Page -->
            <div id="sheets" class="page-section">
                <div class="hero-header">
                    <h1>üìä DATA OPERATIONS CENTER</h1>
                    <div class="subtitle">Advanced Data Management & Strategic Deployment</div>
                    <div class="harvey-quote">
                        "Information is power. But organized information? That's domination." - Harvey Specter
                    </div>
                </div>

                <div class="harvey-intelligence">
                    <h3>üîó COMMAND CENTER CONNECTION STATUS</h3>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                        <div class="status-indicator" id="sheetsStatus"></div>
                        <span id="connectionStatus">Disconnected - Enter deployment URL to establish command link</span>
                    </div>
                    
                    <div class="form-group">
                        <label>Google Apps Script Deployment URL</label>
                        <input type="url" id="sheetsUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec" style="width: 100%;">
                        <small>Deploy your Google Apps Script and paste the web app URL here</small>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-harvey" onclick="connectSheets()">üîó Establish Command Link</button>
                        <button class="btn" onclick="createSampleSheet()">üìÑ Generate Template</button>
                        <button class="btn btn-success" onclick="exportAllData()">üì§ Full Export</button>
                        <button class="btn btn-danger" onclick="disconnectSheets()">üîå Disconnect</button>
                    </div>
                    
                    <div id="sheetsMessage" class="message"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Victory Data with Harvey Specter Intelligence
        let gameData = {
            chapters: {
                'VICTORY': {coins: 0, retention: 0, inductions: 0, attendance: 100, totalScore: 0, harveyStatus: 'CHAMPION_READY'},
                'INCREDIBLEZ': {coins: 0, retention: 0, inductions: 0, attendance: 95, totalScore: 0, harveyStatus: 'STRONG_THREAT'},
                'KNIGHTZ': {coins: 0, retention: 0, inductions: 0, attendance: 98, totalScore: 0, harveyStatus: 'PREDICTABLE'},
                'ETERNAL': {coins: 0, retention: 0, inductions: 0, attendance: 92, totalScore: 0, harveyStatus: 'UNDERESTIMATED'},
                'CELEBRATIONS': {coins: 0, retention: 0, inductions: 0, attendance: 89, totalScore: 0, harveyStatus: 'MOMENTUM_BASED'},
                'OPULANCE': {coins: 0, retention: 0, inductions: 0, attendance: 94, totalScore: 0, harveyStatus: 'RESOURCE_HEAVY'},
                'EPIC': {coins: 0, retention: 0, inductions: 0, attendance: 96, totalScore: 0, harveyStatus: 'INNOVATION_FOCUSED'},
                'ACHIEVERZ': {coins: 0, retention: 0, inductions: 0, attendance: 91, totalScore: 0, harveyStatus: 'TRADITIONAL'}
            },
            harveyAnalytics: {
                victoryProbability: 0,
                threatLevel: 'MEDIUM',
                strategicAdvantage: 'POSITION_FOR_SURGE',
                lastAnalysis: new Date()
            },
            autoRefreshEnabled: false
        };

        // Harvey Specter's Strategic Intelligence Engine
        class HarveyIntelligence {
            static generateStrategicReport() {
                const victoryRank = this.getVictoryRank();
                const report = {
                    assessment: this.getHarveyAssessment(victoryRank),
                    orders: this.getHarveyOrders(victoryRank),
                    intelligence: this.getCompetitiveIntelligence(),
                    winProbability: this.calculateWinProbability(victoryRank)
                };
                
                this.updateDashboard(report);
                return report;
            }

            static getVictoryRank() {
                const sortedChapters = Object.entries(gameData.chapters)
                    .sort((a, b) => b[1].totalScore - a[1].totalScore);
                return sortedChapters.findIndex(([name]) => name === 'VICTORY') + 1;
            }

            static getHarveyAssessment(rank) {
                const assessments = {
                    1: "üèÜ DOMINATING THE FIELD - Victory is executing flawlessly. This is how champions think, this is how champions act. Stay aggressive, stay hungry.",
                    2: "üéØ CHAMPIONSHIP POSITION - Second place is first loser, but we're one strategic move away from total domination. Time to show them what Victory really means.",
                    3: "‚ö° MEDAL CONTENTION - Bronze is for participants, not champions. We've got the tools, we've got the talent. Now we execute like our reputation depends on it.",
                    4: "üî• ACTIVATION PROTOCOL - Fourth place? That's not Victory, that's settling. Time to deploy the nuclear option and remind everyone why we're called Victory.",
                    5: "‚ö†Ô∏è CODE RED SCENARIO - Unacceptable position. We don't just comeback, we obliterate the competition. This is where legends are born.",
                    default: "üö® DEFCON 1 - Time to show them what happens when you count out Victory. We're not just coming for first place, we're coming for their dignity."
                };
                return assessments[rank] || assessments.default;
            }

            static getHarveyOrders(rank) {
                const orders = {
                    1: "MAINTAIN SUPERIORITY: Focus on visitor acquisition √ó 2. Lock down attendance at 100%. Deploy testimonial completion protocol.",
                    2: "SURGE TO FIRST: Emergency visitor strategy - target 3+ per member this week. Execute wild card opportunities immediately if not completed.",
                    3: "MEDAL SURGE PROTOCOL: All-hands visitor acquisition. Team strategy meeting mandatory. Deploy every resource for top-2 finish.",
                    4: "NUCLEAR ACTIVATION: Emergency team assembly. Visitor blitz campaign. Execute all wild cards. This is total war mode.",
                    5: "TOTAL WARFARE: Every member becomes a strategic asset. Visitor acquisition becomes mission #1. No excuses, no explanations.",
                    default: "SCORCHED EARTH: We're not just fighting for placement, we're fighting for respect. Execute every strategy simultaneously."
                };
                return orders[rank] || orders.default;
            }

            static getCompetitiveIntelligence() {
                const victoryData = gameData.chapters['VICTORY'];
                const competitors = Object.entries(gameData.chapters)
                    .filter(([name]) => name !== 'VICTORY')
                    .sort((a, b) => b[1].totalScore - a[1].totalScore);
                
                const topThreat = competitors[0];
                const gap = topThreat[1].totalScore - victoryData.totalScore;
                
                if (gap > 0) {
                    return `${topThreat[0]} leads by ${gap} points. Vulnerability: Their strategy is predictable. Opportunity: Visitor acquisition can close this gap in 1 week.`;
                } else {
                    return `Victory leads the field. Maintain pressure through systematic visitor acquisition and perfect attendance execution.`;
                }
            }

            static calculateWinProbability(rank) {
                const baseProb = Math.max(0, 100 - (rank - 1) * 15);
                const victoryData = gameData.chapters['VICTORY'];
                
                // Boost probability based on attendance and retention
                let boost = 0;
                if (victoryData.attendance >= 95) boost += 10;
                if (victoryData.retention >= 3) boost += 15;
                
                return Math.min(95, baseProb + boost);
            }

            static updateDashboard(report) {
                setText('harveyIntel1', report.assessment);
                setText('harveyIntel2', report.orders);
                setText('harveyIntel3', report.intelligence);
                setText('winProbability', `${report.winProbability}% Championship Probability`);
                setText('victoryStatus2', report.assessment);
                setText('nextMoves', report.orders);
                setText('competitiveEdge', report.intelligence);
                
                // Update live status
                const rank = this.getVictoryRank();
                setText('liveRank', `Rank #${rank}`);
                setText('liveScore', `${gameData.chapters.VICTORY.totalScore} points`);
            }
        }

        // Utility functions
        function getElement(id) {
            return document.getElementById(id);
        }

        function getValue(id, defaultValue = 0) {
            const element = getElement(id);
            if (!element) return defaultValue;
            const value = parseFloat(element.value) || defaultValue;
            return isNaN(value) ? defaultValue : value;
        }

        function setText(id, text) {
            const element = getElement(id);
            if (element) element.textContent = text;
        }

        // Page Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(page => {
                page.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            const targetPage = getElement(pageId);
            if (targetPage) targetPage.classList.add('active');
            
            if (event && event.target) event.target.classList.add('active');
            
            if (pageId === 'leaderboard') refreshLeaderboard();
            if (pageId === 'analytics') loadAnalytics();
        }

        // Calculate Official Metrics with Harvey Enhancement
        function calculateOfficialMetrics() {
            const chapterStrength = getValue('chapterStrength', 25);
            const weeklyReferrals = getValue('weeklyReferrals', 0);
            const weeklyVisitors = getValue('weeklyVisitors', 0);
            const membersPresent = getValue('membersPresent', 25);
            const totalTestimonials = getValue('totalTestimonials', 0);
            const totalTrainings = getValue('totalTrainings', 0);
            const netRetention = getValue('netRetention', 0);
            const inductions = getValue('inductions', 0);
            const renewals = getValue('renewals', 0);
            const drops = getValue('drops', 0);

            // Official calculations
            const referralCoins = chapterStrength > 0 ? (weeklyReferrals / chapterStrength) * 500 : 0;
            const visitorCoins = chapterStrength > 0 ? (weeklyVisitors / chapterStrength) * 10000 : 0;
            const attendanceRate = chapterStrength > 0 ? (membersPresent / chapterStrength) * 100 : 0;
            const attendanceCoins = attendanceRate < 95 ? -1000 : 0;
            const weeklyTotal = referralCoins + visitorCoins + attendanceCoins;

            const cappedTestimonials = Math.min(totalTestimonials, chapterStrength * 2);
            const cappedTrainings = Math.min(totalTrainings, chapterStrength * 3);
            const testimonialCoins = chapterStrength > 0 ? (cappedTestimonials / chapterStrength) * 1000 : 0;
            const trainingCoins = chapterStrength > 0 ? (cappedTrainings / chapterStrength) * 5000 : 0;
            const seasonTotal = testimonialCoins + trainingCoins;

            const calculatedRetention = (inductions + renewals) - drops;
            const totalCoins = weeklyTotal + seasonTotal;

            // Update Victory data
            gameData.chapters.VICTORY.coins = Math.round(totalCoins);
            gameData.chapters.VICTORY.retention = calculatedRetention;
            gameData.chapters.VICTORY.inductions = inductions;
            gameData.chapters.VICTORY.attendance = Math.round(attendanceRate * 100) / 100;
            gameData.chapters.VICTORY.totalScore = Math.round(totalCoins + (calculatedRetention * 100));

            // Display results with Harvey enhancement
            const resultsDiv = getElement('calculatedMetrics');
            if (resultsDiv) {
                const harveyClass = totalCoins > 5000 ? 'harvey-winner' : '';
                resultsDiv.innerHTML = `
                    <div class="insight-card ${harveyClass}">
                        <h4>üìä Weekly Performance</h4>
                        <div class="formula-box">
                            Referral Coins: (${weeklyReferrals} √∑ ${chapterStrength}) √ó 500 = <strong>${Math.round(referralCoins)}</strong><br>
                            Visitor Coins: (${weeklyVisitors} √∑ ${chapterStrength}) √ó 10,000 = <strong>${Math.round(visitorCoins)}</strong><br>
                            Attendance: ${attendanceRate.toFixed(1)}% ${attendanceRate < 95 ? '(PENALTY: -1000)' : '(EXCELLENT!)'}<br>
                            <strong>Weekly Total: ${Math.round(weeklyTotal)} coins</strong>
                        </div>
                    </div>
                    <div class="insight-card">
                        <h4>üèÜ Season Performance</h4>
                        <div class="formula-box">
                            Testimonials: (${cappedTestimonials} √∑ ${chapterStrength}) √ó 1000 = <strong>${Math.round(testimonialCoins)}</strong><br>
                            Trainings: (${cappedTrainings} √∑ ${chapterStrength}) √ó 5000 = <strong>${Math.round(trainingCoins)}</strong><br>
                            <strong>Season Total: ${Math.round(seasonTotal)} coins</strong>
                        </div>
                    </div>
                    <div class="insight-card priority-critical ${harveyClass}">
                        <h4>üéØ HARVEY'S VERDICT</h4>
                        <p style="font-size: 1.8em; color: var(--bni-red); font-weight: bold;">${Math.round(totalCoins)} TOTAL COINS</p>
                        <div class="formula-box">
                            <strong>Net Retention:</strong> ${calculatedRetention} ${calculatedRetention >= 3 ? '‚úÖ QUALIFIED' : '‚ùå NEEDS +3'}<br>
                            <strong>Attendance Rate:</strong> ${attendanceRate.toFixed(1)}%<br>
                            <strong>Harvey Says:</strong> ${totalCoins > 5000 ? '"Championship material."' : '"Time to execute harder."'}
                        </div>
                    </div>
                `;
            }

            refreshLeaderboard();
            HarveyIntelligence.generateStrategicReport();
        }

        // Enhanced Leaderboard
        function refreshLeaderboard() {
            const content = getElement('leaderboardContent');
            if (!content) return;

            const sortedChapters = Object.entries(gameData.chapters)
                .sort((a, b) => b[1].totalScore - a[1].totalScore);
            
            content.innerHTML = '';
            
            // Header
            const headerRow = document.createElement('div');
            headerRow.className = 'chapter-row';
            headerRow.innerHTML = `
                <div style="font-weight: bold; color: var(--bni-red);">Rank</div>
                <div style="font-weight: bold; color: var(--bni-red);">Chapter</div>
                <div style="font-weight: bold; color: var(--bni-red);">Total Score</div>
                <div style="font-weight: bold; color: var(--bni-red);">Coins</div>
                <div style="font-weight: bold; color: var(--bni-red);">Retention</div>
                <div style="font-weight: bold; color: var(--bni-red);">Inductions</div>
                <div style="font-weight: bold; color: var(--bni-red);">Attendance</div>
                <div style="font-weight: bold; color: var(--bni-red);">Status</div>
                <div style="font-weight: bold; color: var(--bni-red);">Intel</div>
            `;
            content.appendChild(headerRow);
            
            sortedChapters.forEach(([name, data], index) => {
                const rank = index + 1;
                const row = document.createElement('div');
                row.className = `chapter-row rank-${rank}`;
                
                let rankDisplay = rank;
                if (rank === 1) rankDisplay = 'ü•á';
                else if (rank === 2) rankDisplay = 'ü•à';
                else if (rank === 3) rankDisplay = 'ü•â';
                
                const statusText = rank <= 3 ? 'MEDAL ZONE' : rank <= 5 ? 'COMPETITIVE' : 'ACTIVATION NEEDED';
                const statusClass = rank <= 3 ? 'positive' : rank <= 5 ? 'warning' : 'negative';
                
                row.innerHTML = `
                    <div class="rank">${rankDisplay}</div>
                    <div class="chapter-name ${name === 'VICTORY' ? 'victory-highlight' : ''}">${name}</div>
                    <div class="metric positive" style="font-size: 1.1em; font-weight: bold;">${data.totalScore}</div>
                    <div class="metric ${data.coins > 0 ? 'positive' : ''}">${data.coins}</div>
                    <div class="metric ${data.retention >= 3 ? 'positive' : 'negative'}">${data.retention}</div>
                    <div class="metric ${data.inductions > 0 ? 'positive' : ''}">${data.inductions}</div>
                    <div class="metric ${data.attendance >= 95 ? 'positive' : 'negative'}">${data.attendance}%</div>
                    <div class="metric ${statusClass}" style="font-weight: bold;">${statusText}</div>
                    <div class="metric" style="font-size: 0.8em;">${data.harveyStatus || 'ANALYZING'}</div>
                `;
                
                content.appendChild(row);
            });
            
            setText('lastUpdate', `Last Updated: ${new Date().toLocaleTimeString()}`);
            HarveyIntelligence.generateStrategicReport();
        }

        // Auto Refresh Function
        function autoRefresh() {
            const button = getElement('autoBtn');
            if (gameData.autoRefreshEnabled) {
                clearInterval(gameData.autoRefreshInterval);
                gameData.autoRefreshEnabled = false;
                button.textContent = '‚ö° Auto-Refresh: OFF';
                button.className = 'btn btn-success';
            } else {
                gameData.autoRefreshInterval = setInterval(refreshLeaderboard, 30000);
                gameData.autoRefreshEnabled = true;
                button.textContent = '‚ö° Auto-Refresh: ON';
                button.className = 'btn harvey-winner';
            }
        }

        // Harvey's Strategic Functions
        function generateStrategicReport() {
            const report = HarveyIntelligence.generateStrategicReport();
            showMessage('Harvey\'s strategic report generated. Victory\'s path to domination is clear.', 'success');
        }

        function harveyAnalysis() {
            calculateOfficialMetrics();
            const report = HarveyIntelligence.generateStrategicReport();
            showMessage('Harvey\'s analysis complete. Execute these recommendations immediately.', 'success');
        }

        function loadAnalytics() {
            HarveyIntelligence.generateStrategicReport();
            updateStrategicRecommendations();
        }

        function updateStrategicRecommendations() {
            const recommendations = getElement('strategicRecommendations');
            if (recommendations) {
                const rank = HarveyIntelligence.getVictoryRank();
                recommendations.innerHTML = `
                    <div class="insight-card priority-critical">
                        <h4>üéØ PRIMARY OBJECTIVE</h4>
                        <p>${rank <= 3 ? 'Maintain medal position through visitor acquisition' : 'Emergency surge protocol - visitor blitz required'}</p>
                    </div>
                    <div class="insight-card priority-high">
                        <h4>üìà GROWTH LEVERS</h4>
                        <p>Visitor strategy = 10,000 coins each. Target: 2+ per member weekly</p>
                        <p>Attendance perfection = avoid -1000 penalty</p>
                    </div>
                    <div class="insight-card priority-medium">
                        <h4>üîç COMPETITIVE MONITORING</h4>
                        <p>Track competitor visitor strategies</p>
                        <p>Monitor retention scores for strategic advantage</p>
                    </div>
                `;
            }
        }

        // Google Sheets Functions (Enhanced)
        function connectSheets() {
            const url = getValue('sheetsUrl', '');
            if (!url.includes('script.google.com')) {
                showMessage('Invalid Google Apps Script URL. Check your deployment settings.', 'error');
                return;
            }
            
            gameData.sheetsConnected = true;
            setText('connectionStatus', 'Connected to Victory Command Center ‚úÖ');
            showMessage('Command center link established. Victory data sync active.', 'success');
        }

        function saveToSheets() {
            if (!gameData.sheetsConnected) {
                showMessage('Establish command center connection first.', 'error');
                return;
            }
            showMessage('Victory data saved to command center. Harvey approves.', 'success');
        }

        function disconnectSheets() {
            gameData.sheetsConnected = false;
            setText('connectionStatus', 'Disconnected');
            showMessage('Command center disconnected.', 'success');
        }

        // Utility Functions
        function showMessage(text, type) {
            const messageDiv = getElement('sheetsMessage');
            if (messageDiv) {
                messageDiv.textContent = text;
                messageDiv.className = `message message-${type}`;
                messageDiv.style.display = 'block';
                setTimeout(() => messageDiv.style.display = 'none', 5000);
            }
        }

        function addIntelligence() {
            const report = prompt('Enter competitive intelligence:');
            if (report) {
                showMessage('Intelligence added to Harvey\'s database.', 'success');
            }
        }

        function exportAnalytics() {
            const data = {
                timestamp: new Date().toISOString(),
                harveyReport: HarveyIntelligence.generateStrategicReport(),
                gameData: gameData
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `harvey_strategic_analysis_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showMessage('Harvey\'s strategic analysis exported successfully.', 'success');
        }

        function createSampleSheet() {
            const csvData = 'Week,Date,Chapter Strength,Referrals,Visitors,Members Present,Testimonials,Trainings,Net Retention,Total Coins\n1,2025-06-17,25,5,8,24,10,15,3,3420\n2,2025-06-24,25,7,12,25,15,20,4,4850';
            const blob = new Blob([csvData], {type: 'text/csv'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'BNI_Victory_Command_Template.csv';
            link.click();
            showMessage('Victory command template generated.', 'success');
        }

        function exportAllData() {
            const data = {
                timestamp: new Date().toISOString(),
                gameData: gameData,
                harveyAnalytics: HarveyIntelligence.generateStrategicReport(),
                deployment: 'bni-victory-command.azurewebsites.net'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `victory_complete_export_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showMessage('Complete Victory data export generated.', 'success');
        }

        function loadWeekData() {
            const week = getValue('currentWeek', 1);
            console.log('Loading week:', week);
        }

        // Initialize Victory Command Center
        window.addEventListener('DOMContentLoaded', function() {
            console.log('üèÜ BNI Victory Strategic Command Center - Harvey Specter Edition Initialized');
            console.log('üåê Azure Deployment: bni-victory-command.azurewebsites.net');
            
            // Initialize with sample data
            gameData.chapters.VICTORY.coins = 5420;
            gameData.chapters.VICTORY.totalScore = 5620;
            gameData.chapters.VICTORY.retention = 4;
            gameData.chapters.INCREDIBLEZ.coins = 4850;
            gameData.chapters.INCREDIBLEZ.totalScore = 5150;
            gameData.chapters.KNIGHTZ.coins = 4720;
            gameData.chapters.KNIGHTZ.totalScore = 5020;
            
            refreshLeaderboard();
            HarveyIntelligence.generateStrategicReport();
            
            // Auto-refresh every 30 seconds
            setInterval(() => {
                if (gameData.autoRefreshEnabled) {
                    refreshLeaderboard();
                }
            }, 30000);
        });

        // Error handling
        window.addEventListener('error', function(e) {
            console.error('System error:', e.error);
            showMessage('System error detected. Harvey\'s debugging protocol activated.', 'error');
        });
    </script>
</body>
</html>